Replication Files for "Heterogeneity and Aggregate Fluctuations"
by Minsu Chang, Xiaohong Chen, and Frank Schorfheide
For questions, please email Frank Schorfheide at schorf@upenn.edu

The scripts in this directory produce the results for Section 5:

/Data/ contains the simulated data from the code in /KS_Solution/
/Figures/ contains the figures generated by the code
/Functions/ contains Julia functions that are used by the scripts
/Results/ contains the main output of the Julia scripts
/SpecFiles/ contains files with information on the fVAR specification and MCMC configurations.

Julia Scripts:

0. script_Pkg_add.jl (optional): run this script if you need to install some of the packages used in the other scripts.

1. script_Density_Estimation.jl: estimates log spline densities by
MLE. Use fVAR10tc.spec for cubic + linear basis

2. script_PredPercentiles_MLE.jl: computes percentiles based on
estimated log spline densities.

3. Graph_Percentiles_MLE.m: generates figure of fitted versus
empirical percentiles (Fig 6).

4. Graph_Densities.m: overlays estimated densities for different K
and histograms. Generates separate figures for each time period (Fig 6).

5. Graph_DensitiesOverlay.m: overlays estimated densities for each
time period (Fig A2).

6. Script_MDD_Estimation.jl: loops over K and lambda to approximate the
MDD (Tab 4).

7. Graph_MDD.m: plots cuts of the MDD surface (not used).

8. script_SS_Estimation.jl: estimates state-space representation
conditional on K and lambda. 
SSspec1: K=10, lambda-hat
SSspec2: K=10, lambda2,3=1
SSspec3: K=22, lambda-hat
SSspec4: K=22, lambda2,3=1

9. script_PredPercentiles_Smoothed.jl: computes percentiles from
smoothed a/alpha states using posterior mean parameter estimates.

10. Graph_Percentiles_Smoothed.m: overlays empirical and smoothed
percentiles.

11. Graph_Alpha_Smoothed.m: overlays actual a-hat's and smoothed
a's (Fig A-3).

12. script_IRF_AggSh.jl: creates IRFs to the three aggregate shocks
identified by Cholesky factorization

13. Graph_IRF_fVAR_AggV_AggSh.m: overlays two sets of IRFs of aggregate variables 
to aggregate shocks (Figs 7 and A-4)

14. script_IRF_Transform.jl: compute IRFs for various
transformations of the original density responses. Use it for aggregate shock

15. Graph_IRF_fVAR_AggSh.m: generates a variety of IRF plots for
aggregate shocks (Fig 8-10).

16. script_IRF_DistrSh.jl: creates IRFs to the distributional shock.

17. script_IRF_Transform.jl: compute IRFs for various
transformations of the original density responses. Use it for distributional shock now. 

18. Graph_IRF_fVAR_DistrSh.m: generates a variety of IRF plots for
distributional shocks (Fig 13)

19. script_AltVAR_MDD_Estimation: compute MDD for hyperparameter
selection. AltMDDspec1 = Pctl, AltMDDspec2 = Gini

20. script_AltVAR_Estimation: estimate alternative VAR conditional on
hyperparameters. AltVARspec1 = Pctl, AltVARspec2 = Gini

21. script_AltVAR_IRF: convert parameters into IRFs.

22. Graph_IRF_fVAR_v_AltVAR: overlay IRFs from functional model and AltVAR (Fig 11, 12)
